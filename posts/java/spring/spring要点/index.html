<!DOCTYPE html>
<html><head>
<title>Spring重点</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="IOC基础">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="Spring重点" />
<meta property="og:description" content="IOC基础" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://brandykk.github.io/posts/java/spring/spring%E8%A6%81%E7%82%B9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-28T21:54:52+08:00" />
<meta property="article:modified_time" content="2021-07-28T21:54:52+08:00" /><meta property="og:site_name" content="白小生" />





<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Spring重点"/>
<meta name="twitter:description" content="IOC基础"/>










  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<link rel="stylesheet" href="/scss/journal.min.c5d92f380bf10f6849c7ac487c7df2b22c081e0851e5339224f1ae29210b20d2.css" integrity="sha256-xdkvOAvxD2hJx6xIfH3ysiwIHghR5TOSJPGuKSELINI=" media="screen">



<link rel="stylesheet" href="/scss/dark-mode.min.9f8d8c2df9285089d141edd4a50cb7506c7948e6ab79a29968dced1bd0ab7d22.css" integrity="sha256-n42MLfkoUInRQe3UpQy3UGx5SOareaKZaNztG9CrfSI=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://brandykk.github.io">
    
        <div class="nav-title">
            Brandy
        </div>
        
        <div class="nav-subtitle">
            个人使用
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                Archive
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Tags
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-ioc%e7%90%86%e8%ae%ba%e6%8e%a8%e5%af%bc" onclick="onNavClick(`#1-ioc理论推导-nav`)" id="1-ioc理论推导-nav">
									1. IOC理论推导
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#11-%e5%8e%9f%e6%9d%a5%e7%9a%84%e5%86%99%e6%b3%95" onclick="onNavClick(`#11-原来的写法-nav`)" id="11-原来的写法-nav">
									1.1. 原来的写法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#111--userdao%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#111--userdao接口-nav`)" id="111--userdao接口-nav">
									1.1.1 UserDao接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#112-userdaoimpl%e5%ae%9e%e7%8e%b0%e7%b1%bb" onclick="onNavClick(`#112-userdaoimpl实现类-nav`)" id="112-userdaoimpl实现类-nav">
									1.1.2 UserDaoImpl实现类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#113-userservice%e4%b8%9a%e5%8a%a1%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#113-userservice业务接口-nav`)" id="113-userservice业务接口-nav">
									1.1.3 UserService业务接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#114-userserviceimpl%e4%b8%9a%e5%8a%a1%e5%ae%9e%e7%8e%b0%e7%b1%bb" onclick="onNavClick(`#114-userserviceimpl业务实现类-nav`)" id="114-userserviceimpl业务实现类-nav">
									1.1.4 UserServiceImpl业务实现类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#115-usertest%e6%b5%8b%e8%af%95" onclick="onNavClick(`#115-usertest测试-nav`)" id="115-usertest测试-nav">
									1.1.5 UserTest测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#12-%e6%9b%b4%e6%94%b9%e4%b9%8b%e5%90%8e" onclick="onNavClick(`#12-更改之后-nav`)" id="12-更改之后-nav">
									1.2 更改之后
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#121-%e5%9c%a8%e4%b8%9a%e5%8a%a1%e5%b1%82%e4%bd%bf%e7%94%a8set%e6%96%b9%e6%b3%95%e8%8e%b7%e5%8f%96dao%e5%ae%9e%e7%8e%b0" onclick="onNavClick(`#121-在业务层使用set方法获取dao实现-nav`)" id="121-在业务层使用set方法获取dao实现-nav">
									1.2.1 在业务层使用set方法获取dao实现
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#122-usertest%e8%b0%83%e7%94%a8" onclick="onNavClick(`#122-usertest调用-nav`)" id="122-usertest调用-nav">
									1.2.2 UserTest调用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#13-hello%e7%a4%ba%e4%be%8b" onclick="onNavClick(`#13-hello示例-nav`)" id="13-hello示例-nav">
									1.3 Hello示例
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#2-%e4%be%9d%e8%b5%96%e6%b3%a8%e5%85%a5" onclick="onNavClick(`#2-依赖注入-nav`)" id="2-依赖注入-nav">
									2. 依赖注入
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-bean%e4%bd%9c%e7%94%a8%e5%9f%9f" onclick="onNavClick(`#3-bean作用域-nav`)" id="3-bean作用域-nav">
									3. bean作用域
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4-bean%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d" onclick="onNavClick(`#4-bean自动装配-nav`)" id="4-bean自动装配-nav">
									4. bean自动装配
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d%e6%b5%8b%e8%af%95" onclick="onNavClick(`#自动装配测试-nav`)" id="自动装配测试-nav">
									自动装配测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d" onclick="onNavClick(`#使用注解自动装配-nav`)" id="使用注解自动装配-nav">
									使用注解自动装配
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e5%bc%80%e5%8f%91" onclick="onNavClick(`#使用注解开发-nav`)" id="使用注解开发-nav">
									使用注解开发
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5-%e4%bd%bf%e7%94%a8java%e6%96%b9%e5%bc%8f%e9%85%8d%e7%bd%aespring" onclick="onNavClick(`#5-使用java方式配置spring-nav`)" id="5-使用java方式配置spring-nav">
									5. 使用java方式配置Spring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6-%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8f" onclick="onNavClick(`#6-代理模式-nav`)" id="6-代理模式-nav">
									6. 代理模式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#61-%e9%9d%99%e6%80%81%e4%bb%a3%e7%90%86" onclick="onNavClick(`#61-静态代理-nav`)" id="61-静态代理-nav">
									6.1. 静态代理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#62-%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86" onclick="onNavClick(`#62-动态代理-nav`)" id="62-动态代理-nav">
									6.2. 动态代理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#7-aop" onclick="onNavClick(`#7-aop-nav`)" id="7-aop-nav">
									7. AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1%e4%bb%80%e4%b9%88%e6%98%afaop" onclick="onNavClick(`#1什么是aop-nav`)" id="1什么是aop-nav">
									1.什么是AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-%e4%bd%bf%e7%94%a8spring%e5%ae%9e%e7%8e%b0aop" onclick="onNavClick(`#2-使用spring实现aop-nav`)" id="2-使用spring实现aop-nav">
									2. 使用Spring实现AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%b8%80%e4%bd%bf%e7%94%a8spring%e7%9a%84api%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#方式一使用spring的api接口-nav`)" id="方式一使用spring的api接口-nav">
									方式一：使用Spring的API接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%ba%8c-%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ae%9e%e7%8e%b0aop" onclick="onNavClick(`#方式二-自定义实现aop-nav`)" id="方式二-自定义实现aop-nav">
									方式二: 自定义实现AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%b8%89%e6%b3%a8%e8%a7%a3%e5%ae%9e%e7%8e%b0" onclick="onNavClick(`#方式三注解实现-nav`)" id="方式三注解实现-nav">
									方式三：注解实现
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#8spring%e6%95%b4%e5%90%88mybatis" onclick="onNavClick(`#8spring整合mybatis-nav`)" id="8spring整合mybatis-nav">
									8.Spring整合Mybatis
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#mybatis%e5%9f%ba%e7%a1%80" onclick="onNavClick(`#mybatis基础-nav`)" id="mybatis基础-nav">
									mybatis基础
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-%e5%af%bc%e5%85%a5%e4%be%9d%e8%b5%96%e5%8c%85" onclick="onNavClick(`#1-导入依赖包-nav`)" id="1-导入依赖包-nav">
									1. 导入依赖包
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-mybatis%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" onclick="onNavClick(`#2-mybatis配置文件-nav`)" id="2-mybatis配置文件-nav">
									2. mybatis配置文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-maper" onclick="onNavClick(`#3-maper-nav`)" id="3-maper-nav">
									3. maper
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4-%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#4-接口-nav`)" id="4-接口-nav">
									4. 接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5-%e5%ae%9e%e4%bd%93%e7%b1%bb" onclick="onNavClick(`#5-实体类-nav`)" id="5-实体类-nav">
									5. 实体类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6-%e6%b5%8b%e8%af%95" onclick="onNavClick(`#6-测试-nav`)" id="6-测试-nav">
									6. 测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%95%b4%e5%90%88%e6%96%b9%e5%bc%8f%e4%b8%80" onclick="onNavClick(`#整合方式一-nav`)" id="整合方式一-nav">
									整合方式一
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1%e7%bc%96%e5%86%99%e6%95%b0%e6%8d%ae%e6%ba%90" onclick="onNavClick(`#1编写数据源-nav`)" id="1编写数据源-nav">
									1.编写数据源
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-sqlsessionfactory" onclick="onNavClick(`#2-sqlsessionfactory-nav`)" id="2-sqlsessionfactory-nav">
									2. sqlSessionFactory
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3sqlsessiontemplate" onclick="onNavClick(`#3sqlsessiontemplate-nav`)" id="3sqlsessiontemplate-nav">
									3.sqlSessionTemplate
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4%e7%bb%99%e6%8e%a5%e5%8f%a3%e6%b7%bb%e5%8a%a0%e5%ae%9e%e7%8e%b0%e7%b1%bb" onclick="onNavClick(`#4给接口添加实现类-nav`)" id="4给接口添加实现类-nav">
									4.给接口添加实现类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5%e5%b0%86%e5%ae%9e%e7%8e%b0%e7%b1%bb%e6%b3%a8%e5%85%a5%e5%88%b0spring" onclick="onNavClick(`#5将实现类注入到spring-nav`)" id="5将实现类注入到spring-nav">
									5.将实现类注入到spring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6%e6%b5%8b%e8%af%95" onclick="onNavClick(`#6测试-nav`)" id="6测试-nav">
									6.测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%ba%8c" onclick="onNavClick(`#方式二-nav`)" id="方式二-nav">
									方式二
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#spring%e6%8e%a7%e5%88%b6%e4%ba%8b%e5%8a%a1" onclick="onNavClick(`#spring控制事务-nav`)" id="spring控制事务-nav">
									spring控制事务
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    Archive
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Tags
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-ioc%e7%90%86%e8%ae%ba%e6%8e%a8%e5%af%bc" onclick="onNavClick(`#1-ioc理论推导-nav`)" id="1-ioc理论推导-nav">
									1. IOC理论推导
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#11-%e5%8e%9f%e6%9d%a5%e7%9a%84%e5%86%99%e6%b3%95" onclick="onNavClick(`#11-原来的写法-nav`)" id="11-原来的写法-nav">
									1.1. 原来的写法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#111--userdao%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#111--userdao接口-nav`)" id="111--userdao接口-nav">
									1.1.1 UserDao接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#112-userdaoimpl%e5%ae%9e%e7%8e%b0%e7%b1%bb" onclick="onNavClick(`#112-userdaoimpl实现类-nav`)" id="112-userdaoimpl实现类-nav">
									1.1.2 UserDaoImpl实现类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#113-userservice%e4%b8%9a%e5%8a%a1%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#113-userservice业务接口-nav`)" id="113-userservice业务接口-nav">
									1.1.3 UserService业务接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#114-userserviceimpl%e4%b8%9a%e5%8a%a1%e5%ae%9e%e7%8e%b0%e7%b1%bb" onclick="onNavClick(`#114-userserviceimpl业务实现类-nav`)" id="114-userserviceimpl业务实现类-nav">
									1.1.4 UserServiceImpl业务实现类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#115-usertest%e6%b5%8b%e8%af%95" onclick="onNavClick(`#115-usertest测试-nav`)" id="115-usertest测试-nav">
									1.1.5 UserTest测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#12-%e6%9b%b4%e6%94%b9%e4%b9%8b%e5%90%8e" onclick="onNavClick(`#12-更改之后-nav`)" id="12-更改之后-nav">
									1.2 更改之后
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#121-%e5%9c%a8%e4%b8%9a%e5%8a%a1%e5%b1%82%e4%bd%bf%e7%94%a8set%e6%96%b9%e6%b3%95%e8%8e%b7%e5%8f%96dao%e5%ae%9e%e7%8e%b0" onclick="onNavClick(`#121-在业务层使用set方法获取dao实现-nav`)" id="121-在业务层使用set方法获取dao实现-nav">
									1.2.1 在业务层使用set方法获取dao实现
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#122-usertest%e8%b0%83%e7%94%a8" onclick="onNavClick(`#122-usertest调用-nav`)" id="122-usertest调用-nav">
									1.2.2 UserTest调用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#13-hello%e7%a4%ba%e4%be%8b" onclick="onNavClick(`#13-hello示例-nav`)" id="13-hello示例-nav">
									1.3 Hello示例
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#2-%e4%be%9d%e8%b5%96%e6%b3%a8%e5%85%a5" onclick="onNavClick(`#2-依赖注入-nav`)" id="2-依赖注入-nav">
									2. 依赖注入
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-bean%e4%bd%9c%e7%94%a8%e5%9f%9f" onclick="onNavClick(`#3-bean作用域-nav`)" id="3-bean作用域-nav">
									3. bean作用域
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4-bean%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d" onclick="onNavClick(`#4-bean自动装配-nav`)" id="4-bean自动装配-nav">
									4. bean自动装配
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d%e6%b5%8b%e8%af%95" onclick="onNavClick(`#自动装配测试-nav`)" id="自动装配测试-nav">
									自动装配测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d" onclick="onNavClick(`#使用注解自动装配-nav`)" id="使用注解自动装配-nav">
									使用注解自动装配
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e5%bc%80%e5%8f%91" onclick="onNavClick(`#使用注解开发-nav`)" id="使用注解开发-nav">
									使用注解开发
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5-%e4%bd%bf%e7%94%a8java%e6%96%b9%e5%bc%8f%e9%85%8d%e7%bd%aespring" onclick="onNavClick(`#5-使用java方式配置spring-nav`)" id="5-使用java方式配置spring-nav">
									5. 使用java方式配置Spring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6-%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8f" onclick="onNavClick(`#6-代理模式-nav`)" id="6-代理模式-nav">
									6. 代理模式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#61-%e9%9d%99%e6%80%81%e4%bb%a3%e7%90%86" onclick="onNavClick(`#61-静态代理-nav`)" id="61-静态代理-nav">
									6.1. 静态代理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#62-%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86" onclick="onNavClick(`#62-动态代理-nav`)" id="62-动态代理-nav">
									6.2. 动态代理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#7-aop" onclick="onNavClick(`#7-aop-nav`)" id="7-aop-nav">
									7. AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1%e4%bb%80%e4%b9%88%e6%98%afaop" onclick="onNavClick(`#1什么是aop-nav`)" id="1什么是aop-nav">
									1.什么是AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-%e4%bd%bf%e7%94%a8spring%e5%ae%9e%e7%8e%b0aop" onclick="onNavClick(`#2-使用spring实现aop-nav`)" id="2-使用spring实现aop-nav">
									2. 使用Spring实现AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%b8%80%e4%bd%bf%e7%94%a8spring%e7%9a%84api%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#方式一使用spring的api接口-nav`)" id="方式一使用spring的api接口-nav">
									方式一：使用Spring的API接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%ba%8c-%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ae%9e%e7%8e%b0aop" onclick="onNavClick(`#方式二-自定义实现aop-nav`)" id="方式二-自定义实现aop-nav">
									方式二: 自定义实现AOP
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%b8%89%e6%b3%a8%e8%a7%a3%e5%ae%9e%e7%8e%b0" onclick="onNavClick(`#方式三注解实现-nav`)" id="方式三注解实现-nav">
									方式三：注解实现
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#8spring%e6%95%b4%e5%90%88mybatis" onclick="onNavClick(`#8spring整合mybatis-nav`)" id="8spring整合mybatis-nav">
									8.Spring整合Mybatis
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#mybatis%e5%9f%ba%e7%a1%80" onclick="onNavClick(`#mybatis基础-nav`)" id="mybatis基础-nav">
									mybatis基础
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-%e5%af%bc%e5%85%a5%e4%be%9d%e8%b5%96%e5%8c%85" onclick="onNavClick(`#1-导入依赖包-nav`)" id="1-导入依赖包-nav">
									1. 导入依赖包
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-mybatis%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" onclick="onNavClick(`#2-mybatis配置文件-nav`)" id="2-mybatis配置文件-nav">
									2. mybatis配置文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-maper" onclick="onNavClick(`#3-maper-nav`)" id="3-maper-nav">
									3. maper
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4-%e6%8e%a5%e5%8f%a3" onclick="onNavClick(`#4-接口-nav`)" id="4-接口-nav">
									4. 接口
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5-%e5%ae%9e%e4%bd%93%e7%b1%bb" onclick="onNavClick(`#5-实体类-nav`)" id="5-实体类-nav">
									5. 实体类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6-%e6%b5%8b%e8%af%95" onclick="onNavClick(`#6-测试-nav`)" id="6-测试-nav">
									6. 测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%95%b4%e5%90%88%e6%96%b9%e5%bc%8f%e4%b8%80" onclick="onNavClick(`#整合方式一-nav`)" id="整合方式一-nav">
									整合方式一
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1%e7%bc%96%e5%86%99%e6%95%b0%e6%8d%ae%e6%ba%90" onclick="onNavClick(`#1编写数据源-nav`)" id="1编写数据源-nav">
									1.编写数据源
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-sqlsessionfactory" onclick="onNavClick(`#2-sqlsessionfactory-nav`)" id="2-sqlsessionfactory-nav">
									2. sqlSessionFactory
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3sqlsessiontemplate" onclick="onNavClick(`#3sqlsessiontemplate-nav`)" id="3sqlsessiontemplate-nav">
									3.sqlSessionTemplate
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4%e7%bb%99%e6%8e%a5%e5%8f%a3%e6%b7%bb%e5%8a%a0%e5%ae%9e%e7%8e%b0%e7%b1%bb" onclick="onNavClick(`#4给接口添加实现类-nav`)" id="4给接口添加实现类-nav">
									4.给接口添加实现类
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5%e5%b0%86%e5%ae%9e%e7%8e%b0%e7%b1%bb%e6%b3%a8%e5%85%a5%e5%88%b0spring" onclick="onNavClick(`#5将实现类注入到spring-nav`)" id="5将实现类注入到spring-nav">
									5.将实现类注入到spring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6%e6%b5%8b%e8%af%95" onclick="onNavClick(`#6测试-nav`)" id="6测试-nav">
									6.测试
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%96%b9%e5%bc%8f%e4%ba%8c" onclick="onNavClick(`#方式二-nav`)" id="方式二-nav">
									方式二
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#spring%e6%8e%a7%e5%88%b6%e4%ba%8b%e5%8a%a1" onclick="onNavClick(`#spring控制事务-nav`)" id="spring控制事务-nav">
									spring控制事务
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://brandykk.github.io">
            Brandy
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://brandykk.github.io">
        <div class="single-column-header-title">Brandy</div>
        
        <div class="single-column-header-subtitle">个人使用</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Spring重点
                    
                    <div class="post-subtitle">
                        IOC基础
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2021-07-28 21:54
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/java">java</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/spring">spring</a>
                                &nbsp;
                            
                        
                        
                            <i class="material-icons" style="">schedule</i>
                            

                            
                            

                            
                            42 min
                            
                            45 s.
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h2 id="1-ioc理论推导">1. IOC理论推导</h2>
<h3 id="11-原来的写法">1.1. 原来的写法</h3>
<h4 id="111--userdao接口">1.1.1  UserDao接口</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">UserDao</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">getUser</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="112-userdaoimpl实现类">1.1.2 UserDaoImpl实现类</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserDaoImpl</span> <span style="color:#8b008b;font-weight:bold">implements</span> UserDao {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">getUser</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;默认获取用户数据&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="113-userservice业务接口">1.1.3 UserService业务接口</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">IUserService</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">getUser</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="114-userserviceimpl业务实现类">1.1.4 UserServiceImpl业务实现类</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserServiceImpl</span> <span style="color:#8b008b;font-weight:bold">implements</span> IUserService {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> UserDao userDao = <span style="color:#8b008b;font-weight:bold">new</span> UserDaoImpl();
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">getUser</span>() {
</span></span><span style="display:flex;"><span>        userDao.<span style="color:#658b00">getUser</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="115-usertest测试">1.1.5 UserTest测试</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//用户实际调用的业务层，Dao层不会直接调用
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        IUserService userService = <span style="color:#8b008b;font-weight:bold">new</span> UserServiceImpl();
</span></span><span style="display:flex;"><span>        userService.<span style="color:#658b00">getUser</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>缺点： 当Dao层需要增加需求时，service业务层的代码也需要跟着改变，耦合度太高</p>
<h3 id="12-更改之后">1.2 更改之后</h3>
<h4 id="121-在业务层使用set方法获取dao实现">1.2.1 在业务层使用set方法获取dao实现</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserServiceImpl</span> <span style="color:#8b008b;font-weight:bold">implements</span> IUserService {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> UserDao userDao;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setUserDao</span>(UserDao userDao) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">userDao</span> = userDao;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">getUser</span>() {
</span></span><span style="display:flex;"><span>        userDao.<span style="color:#658b00">getUser</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="122-usertest调用">1.2.2 UserTest调用</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//用户实际调用的业务层，Dao层不会直接调用
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        UserServiceImpl userService = <span style="color:#8b008b;font-weight:bold">new</span> UserServiceImpl();
</span></span><span style="display:flex;"><span>        userService.<span style="color:#658b00">setUserDao</span>(<span style="color:#8b008b;font-weight:bold">new</span> UserDaoMysqlImpl());
</span></span><span style="display:flex;"><span>        userService.<span style="color:#658b00">getUser</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>这样在dao层添加新逻辑时，service不需要改动，只需要改变调用就可以，耦合度大大降低。</li>
</ul>
<blockquote>
<p>控制反转IOC（Inversion of Control），是一种设计思想，DI（依赖注入）是实现IOC的一种方法。IOC是Spring框架的核心内容。</p>
</blockquote>
<blockquote>
<p>Spring容器在初始化时先读取配置文件，根据配置文件或元数据创建与组织对象存入容器中，程序使用时再从IOC容器中取出需要的对象。</p>
<p><img src="spring-IOC.assets/image-20210728223218678.png" alt="image-20210728223218678"></p>
<p>采用XML方式配置Bean的时候，Bean的定义信息是和实现分离的，而采用注解的方式可以把两者合为一体，Bean的定义信息直接以注解的形式定义在实现类中，从而达到了零配置的目的。</p>
</blockquote>
<p><strong>控制反转是一种通过描述（XML或注解）并通过第三方去生产或获取特定对象的方式，在Sring中实现控制反转的是IOC容器，其实现方式是依赖注入（Dependency Injection,DI）。</strong></p>
<h3 id="13-hello示例">1.3 Hello示例</h3>
<ol>
<li>
<p><code>Hello.Class</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Hello</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String str;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getStr</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> str;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setStr</span>(String str) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">str</span> = str;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;Hello{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;str=&#39;&#34;</span> + str + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p><code>bean.xml</code></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--使用Spring创建对象，在Spring中这些都称为Bean--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    类型  变量名 =   new     类型（）
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    Hello hello = new Hello();
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    id: 变量名
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    class: new 的对象
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    property： 相当于给属性赋值
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">	ref : 引用Spring容器中创建的对象
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">	value： 给具体的属性赋值
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;hello&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.Hello&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;str&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;Spring&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;bean id=&#34;userDao&#34; class=&#34;lv.dao.impl.UserDaoImpl&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;bean id=&#34;userDaoMysql&#34; class=&#34;lv.dao.impl.UserDaoMysqlImpl&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;bean id=&#34;userService&#34; class=&#34;lv.service.impl.UserServiceImpl&#34;&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--        &lt;property name=&#34;userDao&#34; ref=&#34;userDao&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;/bean&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div><ol start="3">
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.Hello</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.ApplicationContext</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">HelloTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//获取Spring的上下文对象
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        ApplicationContext applicationContext = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;bean.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//获取XML中设置的bean
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        Hello hello = (Hello) applicationContext.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;hello&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(hello);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ol>
<ul>
<li>Hello对象是由Spring创建的</li>
<li>Hello对象的属性由Spring容器设置</li>
</ul>
<p>这个过程就叫控制反转：</p>
<p>控制：谁来控制对象的创建，传统应用程序的对象是由程序本身控制创建的，使用Spring后，对象是由Spring创建。</p>
<p>反转：程序本身不创建对象，而变成被动的接受对象。</p>
<p>依赖注入：利用set方法来进行注入的</p>
<p>IOC是一种编程思想，由主动的编程变成被动的接收。</p>
<blockquote>
<p><strong>对象由Spring来创建、管理、装配！</strong></p>
<p><strong>在配置文件加载的时候，容器中的对象已经初始化</strong></p>
</blockquote>
<h2 id="2-依赖注入">2. 依赖注入</h2>
<ul>
<li>构造器注入</li>
</ul>
<p>上面的就是构造器注入</p>
<ul>
<li>
<p>set方法注入</p>
<ul>
<li>依赖： bean对象的创建依赖于容器</li>
<li>注入： bean对象中的所有属性，由容器来注入</li>
</ul>
<p>[环境搭建]</p>
<ol>
<li>
<p>复杂类型</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Address</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String address;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getAddress</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> address;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setAddress</span>(String address) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">address</span> = address;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;Address{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;address=&#39;&#34;</span> + address + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>真实测试对象</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.*</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Students</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Address address;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String[] books;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> List&lt;String&gt; hobbys;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Map&lt;String,String&gt; card;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Set&lt;String&gt; games;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Properties info;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String wife;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Address <span style="color:#008b45">getAddress</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> address;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setAddress</span>(Address address) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">address</span> = address;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String[] <span style="color:#008b45">getBooks</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> books;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setBooks</span>(String[] books) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">books</span> = books;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> List&lt;String&gt; <span style="color:#008b45">getHobbys</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> hobbys;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setHobbys</span>(List&lt;String&gt; hobbys) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">hobbys</span> = hobbys;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Map&lt;String, String&gt; <span style="color:#008b45">getCard</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> card;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setCard</span>(Map&lt;String, String&gt; card) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">card</span> = card;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Set&lt;String&gt; <span style="color:#008b45">getGames</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> games;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setGames</span>(Set&lt;String&gt; games) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">games</span> = games;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Properties <span style="color:#008b45">getInfo</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> info;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setInfo</span>(Properties info) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">info</span> = info;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getWife</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> wife;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setWife</span>(String wife) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">wife</span> = wife;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;Students{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, address=&#34;</span> + address +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, books=&#34;</span> + Arrays.<span style="color:#658b00">toString</span>(books) +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, hobbys=&#34;</span> + hobbys +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, card=&#34;</span> + card +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, games=&#34;</span> + games +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, info=&#34;</span> + info +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, wife=&#39;&#34;</span> + wife + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>&lt;?xml version=<span style="color:#cd5555">&#34;1.0&#34;</span> encoding=<span style="color:#cd5555">&#34;UTF-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;beans xmlns=<span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       xmlns:xsi=<span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       xsi:schemaLocation=<span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;!--<span style="color:#a61717;background-color:#e3d2d2">注入</span>bean--&gt;
</span></span><span style="display:flex;"><span>    &lt;bean id=<span style="color:#cd5555">&#34;address&#34;</span> class=<span style="color:#cd5555">&#34;lv.Address&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;bean id=<span style="color:#cd5555">&#34;student&#34;</span> class=<span style="color:#cd5555">&#34;lv.Students&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">第一种：普通的值注入，</span>value--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;name&#34;</span> value=<span style="color:#cd5555">&#34;斌&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">第二种：</span> bean<span style="color:#a61717;background-color:#e3d2d2">注入，</span>ref--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;address&#34;</span> ref=<span style="color:#cd5555">&#34;address&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">数组注入：</span>ref--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;books&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;array&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;<span style="color:#a61717;background-color:#e3d2d2">西游记</span>&lt;/value&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;<span style="color:#a61717;background-color:#e3d2d2">红楼梦</span>&lt;/value&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;<span style="color:#a61717;background-color:#e3d2d2">三国</span>&lt;/value&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;<span style="color:#a61717;background-color:#e3d2d2">水浒</span>&lt;/value&gt;
</span></span><span style="display:flex;"><span>            &lt;/array&gt;
</span></span><span style="display:flex;"><span>        &lt;/property&gt;
</span></span><span style="display:flex;"><span>        &lt;!--list<span style="color:#a61717;background-color:#e3d2d2">注入：</span>ref--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;hobbys&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;list&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;<span style="color:#a61717;background-color:#e3d2d2">听歌</span>&lt;/value&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;<span style="color:#a61717;background-color:#e3d2d2">打球</span>&lt;/value&gt;
</span></span><span style="display:flex;"><span>            &lt;/list&gt;
</span></span><span style="display:flex;"><span>        &lt;/property&gt;
</span></span><span style="display:flex;"><span>        &lt;!--map<span style="color:#a61717;background-color:#e3d2d2">注入：</span> ref--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;card&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;map&gt;
</span></span><span style="display:flex;"><span>                &lt;entry key=<span style="color:#cd5555">&#34;身份证&#34;</span> value=<span style="color:#cd5555">&#34;123456&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>                &lt;entry key=<span style="color:#cd5555">&#34;银行卡&#34;</span> value=<span style="color:#cd5555">&#34;456789&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>            &lt;/map&gt;
</span></span><span style="display:flex;"><span>        &lt;/property&gt;
</span></span><span style="display:flex;"><span>        &lt;!--set<span style="color:#a61717;background-color:#e3d2d2">注入：</span> ref--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;games&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;set&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;LOL&lt;/value&gt;
</span></span><span style="display:flex;"><span>                &lt;value&gt;GTA5&lt;/value&gt;
</span></span><span style="display:flex;"><span>            &lt;/set&gt;
</span></span><span style="display:flex;"><span>        &lt;/property&gt;
</span></span><span style="display:flex;"><span>        &lt;!--null<span style="color:#a61717;background-color:#e3d2d2">注入</span>--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;wife&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#8b008b;font-weight:bold">null</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;/property&gt;
</span></span><span style="display:flex;"><span>        &lt;!--properties<span style="color:#a61717;background-color:#e3d2d2">注入：</span> ref--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;info&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;props&gt;
</span></span><span style="display:flex;"><span>                &lt;prop key=<span style="color:#cd5555">&#34;sql&#34;</span>&gt;mysql&lt;/prop&gt;
</span></span><span style="display:flex;"><span>                &lt;prop key=<span style="color:#cd5555">&#34;port&#34;</span>&gt;<span style="color:#b452cd">8080</span>&lt;/prop&gt;
</span></span><span style="display:flex;"><span>            &lt;/props&gt;
</span></span><span style="display:flex;"><span>        &lt;/property&gt;
</span></span><span style="display:flex;"><span>    &lt;/bean&gt;
</span></span><span style="display:flex;"><span>&lt;/beans&gt;
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;application.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        Students student = (Students) app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;student&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(student);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//输出： Students{name=&#39;斌&#39;, address=Address{address=&#39;null&#39;}, books=[西游记, 红楼梦, 三国, 水浒], hobbys=[听歌, 打球], card={身份证=123456, 银行卡=456789}, games=[LOL, GTA5], info={port=8080, sql=mysql}, wife=&#39;null&#39;}
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div></li>
</ol>
</li>
<li>
<p>拓展方式注入</p>
<ul>
<li>
<p>p命名空间</p>
<ul>
<li>
<p>例子</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">User</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> age;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">int</span> <span style="color:#008b45">getAge</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setAge</span>(<span style="color:#00688b;font-weight:bold">int</span> age) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">age</span> = age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;User{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, age=&#34;</span> + age +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:p=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/p&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--p命名空间 可以直接给属性注入值： property
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        需要在上面配置上：xmlns:p=&#34;http://www.springframework.org/schema/p&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;user&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.User&#34;</span> <span style="color:#658b00">p:name=</span><span style="color:#cd5555">&#34;名字&#34;</span> <span style="color:#658b00">p:age=</span><span style="color:#cd5555">&#34;188&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@org.junit.Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">ptest</span>() {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;bean.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        User user = (User) app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;user&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(user);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//输出： User{name=&#39;名字&#39;, age=188}
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    }
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>c命名空间</p>
<ul>
<li>
<p>例子</p>
<blockquote>
<p>需要有构造器</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">User</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> age;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">User</span>() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">User</span>(String name, <span style="color:#00688b;font-weight:bold">int</span> age) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">age</span> = age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">int</span> <span style="color:#008b45">getAge</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setAge</span>(<span style="color:#00688b;font-weight:bold">int</span> age) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">age</span> = age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;User{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, age=&#34;</span> + age +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:c=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/c&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--c命名空间 可以直接给属性注入值： 需要构造器
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">            需要在上面配置上：xmlns:c=&#34;http://www.springframework.org/schema/c&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;user2&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.User&#34;</span> <span style="color:#658b00">c:name=</span><span style="color:#cd5555">&#34;构造器&#34;</span> <span style="color:#658b00">c:age=</span><span style="color:#cd5555">&#34;188&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@org.junit.Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">ptest</span>() {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;bean.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        User user = (User) app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;user2&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(user);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//输出： User{name=&#39;构造器&#39;, age=188}
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    }
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="3-bean作用域">3. bean作用域</h2>
<p><img src="spring-IOC.assets/image-20210801145956243.png" alt="image-20210801145956243"></p>
<ol>
<li>
<p>单例模式（Spring默认机制）</p>
<blockquote>
<p>只创建一个对象，所有bean共享一个对象</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#228b22">&lt;!--使用scope设置--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;user2&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.User&#34;</span> <span style="color:#658b00">c:name=</span><span style="color:#cd5555">&#34;构造器&#34;</span> <span style="color:#658b00">c:age=</span><span style="color:#cd5555">&#34;188&#34;</span> <span style="color:#658b00">scope=</span><span style="color:#cd5555">&#34;singleton&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>原型模式</p>
<blockquote>
<p>每一个bean都创建一个单独的对象</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>&lt;bean id=<span style="color:#cd5555">&#34;user2&#34;</span> class=<span style="color:#cd5555">&#34;lv.User&#34;</span> c:name=<span style="color:#cd5555">&#34;构造器&#34;</span> c:age=<span style="color:#cd5555">&#34;188&#34;</span> scope=<span style="color:#cd5555">&#34;prototype&#34;</span>/&gt;
</span></span></code></pre></div></li>
<li>
<p>其他的只能在web开发中使用到</p>
</li>
</ol>
<h2 id="4-bean自动装配">4. bean自动装配</h2>
<ul>
<li>自动装配是Spring满足bean依赖的一种方式</li>
<li>Spring会在上下文中自动寻找，并自动给bean装配属性</li>
</ul>
<p>在spring中有三种装配方式</p>
<ol>
<li>在xml中显示的配置</li>
<li>在java中显示配置</li>
<li>隐式的自动装配bean「重要」</li>
</ol>
<h3 id="自动装配测试">自动装配测试</h3>
<ul>
<li>
<p>例子</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Cat</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">shout</span>(){
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;瞄&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Dog</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">shout</span>(){
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;汪&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">People</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Dog dog;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Cat cat;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Dog <span style="color:#008b45">getDog</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> dog;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setDog</span>(Dog dog) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">dog</span> = dog;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Cat <span style="color:#008b45">getCat</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> cat;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setCat</span>(Cat cat) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">cat</span> = cat;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;People{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;dog=&#34;</span> + dog +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, cat=&#34;</span> + cat +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;dog&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.Dog&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;cat&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.Cat&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--普通的写法--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;bean id=&#34;people&#34; class=&#34;lv.People&#34;&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;property name=&#34;name&#34; value=&#34;小明&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;property name=&#34;cat&#34; ref=&#34;cat&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;property name=&#34;dog&#34; ref=&#34;dog&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;/bean&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--自动装配 autowire:
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        byName ： 会自动在容器上下文中查找，和自己对象set方法后面的值对应的beanid
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        byType : 会自动在容器上下文中查找，和自己对象属性类型相同的bean
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;people&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.People&#34;</span> <span style="color:#658b00">autowire=</span><span style="color:#cd5555">&#34;byName&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;name&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;小明&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#707a7c">@org.junit.Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">peopletest</span>() {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;bean.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        People people = app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;people&#34;</span>, People.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        people.<span style="color:#658b00">getCat</span>().<span style="color:#658b00">shout</span>();
</span></span><span style="display:flex;"><span>        people.<span style="color:#658b00">getDog</span>().<span style="color:#658b00">shout</span>();
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div></li>
</ul>
<blockquote>
<p>byname： 需要保证所有bean的id唯一，并且需要和自动注入的属性的set方法的值一致</p>
<p>bytype ： 需要保证所有bean的class唯一，并且需要和自动注入的属性的类型一致</p>
</blockquote>
<h3 id="使用注解自动装配">使用注解自动装配</h3>
<blockquote>
<p>JDK1.5，Spring2.5支持注解</p>
</blockquote>
<ul>
<li>
<p>导入约束</p>
</li>
<li>
<p>配置注解支持</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:context=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/context
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/context/spring-context.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--需要导入 xmlns:context=&#34;http://www.springframework.org/schema/context&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        在xsi:schemaLocation中加入 ： http://www.springframework.org/schema/context
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        http://www.springframework.org/schema/context/spring-context.xsd&#34;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--开启注解支持--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;context:annotation-config/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;dog&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.Dog&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;cat&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.Cat&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;people&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.People&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div><p>测试：</p>
<p>在bean上加注解<code>@Autowired</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.beans.factory.annotation.Autowired</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">People</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Dog dog;
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Cat cat;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Dog <span style="color:#008b45">getDog</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> dog;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setDog</span>(Dog dog) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">dog</span> = dog;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Cat <span style="color:#008b45">getCat</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> cat;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setCat</span>(Cat cat) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">cat</span> = cat;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;People{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;dog=&#34;</span> + dog +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, cat=&#34;</span> + cat +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<ol start="5">
<li>
<h2 id="使用注解开发">使用注解开发</h2>
<ol>
<li>在Spring4之后，使用注解开发必须保证aop包导入</li>
</ol>
<p><img src="spring-IOC.assets/image-20210801161040115.png" alt="image-20210801161040115"></p>
</li>
</ol>
<p>使用注解需要导入context约束，增加注解支持</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:context=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/context
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/context/spring-context.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--需要导入 xmlns:context=&#34;http://www.springframework.org/schema/context&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        在xsi:schemaLocation中加入 ： http://www.springframework.org/schema/context
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">        http://www.springframework.org/schema/context/spring-context.xsd&#34;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--开启注解支持--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;context:annotation-config/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div><ol start="2">
<li>
<p>属性注入</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.pojo</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.beans.factory.annotation.Value</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.stereotype.Component</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * @Component： 组件 等价于： &lt;bean id=&#34;user&#34; class=&#34;lv.pojo.User&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Component</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">User</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * @Value(&#34;小明&#34;)：给属性赋值 等价于 &lt;property name=&#34;name&#34; value=&#34;小明&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Value</span>(<span style="color:#cd5555">&#34;小明&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">//    @Value(&#34;小明&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">//    public void setName(String name) {
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">//        this.name = name;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">//    }
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>}
</span></span></code></pre></div></li>
<li>
<p>衍生的注解</p>
<p><code>@Component</code>衍生注解</p>
<ul>
<li>
<p><code>@Repository</code> : dao层注解</p>
</li>
<li>
<p><code>@Service</code> : service层注解</p>
</li>
<li>
<p><code>@Controller</code> : controller层注解</p>
<blockquote>
<p>都代表将类注入到Srping中，装配bean</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<h2 id="5-使用java方式配置spring">5. 使用java方式配置Spring</h2>
<p>完全不使用xml，全部交给java</p>
<blockquote>
<p>javaConfig是一个子项目，在Spring4之后成为核心功能</p>
</blockquote>
<ul>
<li>
<p>实体类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.pojo</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.beans.factory.annotation.Value</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.stereotype.Component</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Component</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">User</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Value</span>(<span style="color:#cd5555">&#34;小明&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Value</span>(<span style="color:#cd5555">&#34;18&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> age;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">int</span> <span style="color:#008b45">getAge</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setAge</span>(<span style="color:#00688b;font-weight:bold">int</span> age) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">age</span> = age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;User{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, age=&#34;</span> + age +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>配置类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.config</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.pojo.User</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.annotation.Bean</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.annotation.Configuration</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * @Configuration: 配置类，相当于原来的xml
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">LvConfig</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> User <span style="color:#008b45">getUser</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#8b008b;font-weight:bold">new</span> User();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.config.LvConfig</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.pojo.User</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.ApplicationContext</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Test</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> AnnotationConfigApplicationContext(LvConfig.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        User user = app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;getUser&#34;</span>, User.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(user);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<h2 id="6-代理模式">6. 代理模式</h2>
<ul>
<li>静态代理</li>
<li>动态代理</li>
</ul>
<p><img src="spring-IOC.assets/image-20210801165008933.png" alt="image-20210801165008933"></p>
<h3 id="61-静态代理">6.1. 静态代理</h3>
<p>角色分析：</p>
<ul>
<li>抽象角色：一般会使用接口或抽象类解决</li>
<li>真实角色： 被代理的角色</li>
<li>代理角色： 代理真实角色后，一般会做一些附属操作</li>
<li>客户： 访问代理对象的人</li>
</ul>
<p>代码步骤：</p>
<ol>
<li>
<p>接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">//租房
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">Rent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">rent</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>真实角色</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">//房东
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Host</span> <span style="color:#8b008b;font-weight:bold">implements</span> Rent{
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">rent</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;房东要租房&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>代理角色</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.demo01</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Proxy</span> <span style="color:#8b008b;font-weight:bold">implements</span> Rent {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> Host host;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">Proxy</span>() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">Proxy</span>(Host host) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">host</span> = host;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">rent</span>() {
</span></span><span style="display:flex;"><span>        seeHonse();
</span></span><span style="display:flex;"><span>        host.<span style="color:#658b00">rent</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">seeHonse</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;中介看房&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>客户访问</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        Proxy proxy = <span style="color:#8b008b;font-weight:bold">new</span> Proxy(<span style="color:#8b008b;font-weight:bold">new</span> Host());
</span></span><span style="display:flex;"><span>        proxy.<span style="color:#658b00">rent</span>();
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div></li>
</ol>
<p>代理模式的好处：</p>
<ul>
<li>可以是真实角色的操作更加纯粹！不去关注公共业务</li>
<li>公共业务交给代理，实现业务分工</li>
<li>公共业务扩展的时候，方便集中管理</li>
</ul>
<p>缺点：</p>
<ul>
<li>一个真实角色就会产生一个代理角色；开发效率太低</li>
</ul>
<p><img src="spring-IOC.assets/image-20210801170626012.png" alt="image-20210801170626012"></p>
<h3 id="62-动态代理">6.2. 动态代理</h3>
<ul>
<li>和静态代理角色一样</li>
<li>动态代理的代理类是动态生成的</li>
<li>动态代理分为两大类
<ul>
<li>基于接口的动态代理
<ul>
<li>JDK动态代理</li>
</ul>
</li>
<li>基于类的动态代理
<ul>
<li>cglib</li>
</ul>
</li>
<li>java字节码实现
<ul>
<li>javassist</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>需要了解两个类：Proxy：代理,  invocationHandler: 调用处理程序</p>
<ol>
<li>
<p>接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">//租房
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">Rent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">rent</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>真实对象</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">//房东
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Host</span> <span style="color:#8b008b;font-weight:bold">implements</span> Rent {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">rent</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;房东要租房&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>处理程序</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.demo02</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.lang.reflect.InvocationHandler</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.lang.reflect.Method</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.lang.reflect.Proxy</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * 自动生成代理类
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ProxyInvocationHandler</span> <span style="color:#8b008b;font-weight:bold">implements</span> InvocationHandler {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//被代理的接口
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">private</span> Object obj;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//处理代理实例并返回结果
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> Object <span style="color:#008b45">invoke</span>(Object proxy, Method method, Object[] args) <span style="color:#8b008b;font-weight:bold">throws</span> Throwable {
</span></span><span style="display:flex;"><span>        Object invoke = method.<span style="color:#658b00">invoke</span>(obj, args);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> invoke;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//得到生成的代理类
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> Object <span style="color:#008b45">getProxy</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> Proxy.<span style="color:#658b00">newProxyInstance</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">getClass</span>().<span style="color:#658b00">getClassLoader</span>(), obj.<span style="color:#658b00">getClass</span>().<span style="color:#658b00">getInterfaces</span>(), <span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setObj</span>(Object obj) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">obj</span> = obj;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>调用</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.demo02</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Test</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//真实角色
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        Host host = <span style="color:#8b008b;font-weight:bold">new</span> Host();
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//代理角色： 现在没有
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        ProxyInvocationHandler pr = <span style="color:#8b008b;font-weight:bold">new</span> ProxyInvocationHandler();
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//通过调用程序处理角色来处理我们要调用的接口对象
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        pr.<span style="color:#658b00">setObj</span>(host);
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//获取代理角色： 这里是动态生成的
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        Rent rent = (Rent) pr.<span style="color:#658b00">getProxy</span>();
</span></span><span style="display:flex;"><span>        rent.<span style="color:#658b00">rent</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>好处：</p>
<ul>
<li>
<p>有静态代理的所有好处</p>
</li>
<li>
<p>一个动态代理类可以代理多个类，只要实现了同一个接口</p>
</li>
</ul>
</li>
</ol>
<h2 id="7-aop">7. AOP</h2>
<h3 id="1什么是aop">1.什么是AOP</h3>
<p>AOP（Aspect Oriented Programming）意为：面向切面编程，通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring中的重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高开发效率。</p>
<p><img src="spring-IOC.assets/image-20210801174416415.png" alt="image-20210801174416415"></p>
<p>==提供声明式事物，允许用户自定义切面==</p>
<ul>
<li>横切关注点：跨越应用程序多个模块的方法或功能。即是：与我们业务逻辑无关的，但是我们需要关注的部分，就是横切关注点。如 日志、安全、缓存、事物等</li>
<li>切面（ASPECT）：横切关注点被模块化的特殊对象。即 一个类</li>
<li>通知（Advice）：切面必须完成的工作。即：类中的一个方法</li>
<li>目标（Target）：被通知对象</li>
<li>代理（Proxy）：向目标对象应用通知之后创建的对象。</li>
<li>切入点（PointCut）：切面通知执行的“地点”的定义</li>
<li>连接点（JointPoint）：与切入点匹配的执行点</li>
</ul>
<p><img src="spring-IOC.assets/image-20210801180433641.png" alt="image-20210801180433641"></p>
<p>SpringAop中，通过Advice定义横切逻辑，Spring支持5中类型的Advice</p>
<p><img src="spring-IOC.assets/image-20210801180545277.png" alt="image-20210801180545277"></p>
<p>即：AOP在不改变原代码的情况下，增加新功能。</p>
<h3 id="2-使用spring实现aop">2. 使用Spring实现AOP</h3>
<blockquote>
<p>导入依赖</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.aspectj<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>aspectjweaver<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>1.9.4<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id="方式一使用spring的api接口">方式一：使用Spring的API接口</h4>
<ol>
<li>
<p>接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.service</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">UserService</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">add</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">delete</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">update</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">query</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>实现接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.service.impl</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.service.UserService</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserServiceimpl</span> <span style="color:#8b008b;font-weight:bold">implements</span> UserService {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">add</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;增加了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">delete</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;删除了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">update</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;修改了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">query</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;查询  了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>执行开始的日志类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.log</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.aop.MethodBeforeAdvice</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.lang.reflect.Method</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Log</span> <span style="color:#8b008b;font-weight:bold">implements</span> MethodBeforeAdvice {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * @param method  执行的目标对象的方法
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * @param objects 参数
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * @param o       目标对象
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * @throws Throwable
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">before</span>(Method method, Object[] objects, Object o) <span style="color:#8b008b;font-weight:bold">throws</span> Throwable {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(o.<span style="color:#658b00">getClass</span>().<span style="color:#658b00">getName</span>() + <span style="color:#cd5555">&#34;的&#34;</span> + method.<span style="color:#658b00">getName</span>() + <span style="color:#cd5555">&#34;方法被执行了&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>执行结束的日志</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.log</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.aop.AfterReturningAdvice</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.lang.reflect.Method</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">AfterLog</span> <span style="color:#8b008b;font-weight:bold">implements</span> AfterReturningAdvice {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//o ： 返回值
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">afterReturning</span>(Object o, Method method, Object[] objects, Object o1) <span style="color:#8b008b;font-weight:bold">throws</span> Throwable {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(o1.<span style="color:#658b00">getClass</span>().<span style="color:#658b00">getName</span>() + <span style="color:#cd5555">&#34;的&#34;</span> + method.<span style="color:#658b00">getName</span>() + <span style="color:#cd5555">&#34;返回: &#34;</span> + o);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:aop=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;userService&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.service.impl.UserServiceimpl&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;log&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.log.Log&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;afterLog&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.log.AfterLog&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--需要导入aop的约束
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    xmlns:aop=&#34;http://www.springframework.org/schema/aop&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--方式一:原生API--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;aop:config&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--切入点expression表达式 expression(要执行的位置 修饰词(public/private等) 返回值 类名 方法名 参数)--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;poincut&#34;</span> <span style="color:#658b00">expression=</span><span style="color:#cd5555">&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--执行环绕增加! 将log类和afterLog类切入到上面配置的方法上 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;aop:advisor</span> <span style="color:#658b00">advice-ref=</span><span style="color:#cd5555">&#34;log&#34;</span> <span style="color:#658b00">pointcut-ref=</span><span style="color:#cd5555">&#34;poincut&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;aop:advisor</span> <span style="color:#658b00">advice-ref=</span><span style="color:#cd5555">&#34;afterLog&#34;</span> <span style="color:#658b00">pointcut-ref=</span><span style="color:#cd5555">&#34;poincut&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/aop:config&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.service.UserService</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.ApplicationContext</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Test</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;applicationContext.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        UserService userservice = app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;userService&#34;</span>, UserService.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        userservice.<span style="color:#658b00">add</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>结果:</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#888">lv.service.impl.UserServiceimpl的add方法被执行了
</span></span></span><span style="display:flex;"><span><span style="color:#888">增加了有一个用户
</span></span></span><span style="display:flex;"><span><span style="color:#888">lv.service.impl.UserServiceimpl的add返回: null
</span></span></span></code></pre></div></li>
</ol>
<h4 id="方式二-自定义实现aop">方式二: 自定义实现AOP</h4>
<ol>
<li>
<p>接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.service</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">UserService</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">add</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">delete</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">update</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">query</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>接口实现</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.service.impl</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.service.UserService</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserServiceimpl</span> <span style="color:#8b008b;font-weight:bold">implements</span> UserService {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">add</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;增加了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">delete</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;删除了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">update</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;修改了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">query</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;查询  了有一个用户&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>自定义point类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.diy</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">DiyPoinCut</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">before</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;方法执行前&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">after</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;方法执行后&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:aop=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;userService&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.service.impl.UserServiceimpl&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;log&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.log.Log&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;afterLog&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.log.AfterLog&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--需要导入aop的约束
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    xmlns:aop=&#34;http://www.springframework.org/schema/aop&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--方式一:原生API--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;aop:config&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &amp;lt;!&amp;ndash;切入点expression表达式 expression(要执行的位置 修饰词(public/private等) 返回值 类名 方法名 参数)&amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:pointcut id=&#34;poincut&#34; expression=&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &amp;lt;!&amp;ndash;执行环绕增加! 将log类和afterLog类切入到上面配置的方法上 &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:advisor advice-ref=&#34;log&#34; pointcut-ref=&#34;poincut&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:advisor advice-ref=&#34;afterLog&#34; pointcut-ref=&#34;poincut&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;/aop:config&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--方式二:自定义类--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;diy&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.diy.DiyPoinCut&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;aop:config&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--挂载自定义类的beanid--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;aop:aspect</span> <span style="color:#658b00">ref=</span><span style="color:#cd5555">&#34;diy&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#228b22">&lt;!--切入点--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;point&#34;</span> <span style="color:#658b00">expression=</span><span style="color:#cd5555">&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#228b22">&lt;!--通知--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;aop:before</span> <span style="color:#658b00">method=</span><span style="color:#cd5555">&#34;before&#34;</span> <span style="color:#658b00">pointcut-ref=</span><span style="color:#cd5555">&#34;point&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;aop:after</span> <span style="color:#658b00">method=</span><span style="color:#cd5555">&#34;after&#34;</span> <span style="color:#658b00">pointcut-ref=</span><span style="color:#cd5555">&#34;point&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/aop:aspect&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/aop:config&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>测试类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
</span></span><span style="display:flex;"><span>        ApplicationContext app = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;applicationContext.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        UserService userservice = app.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;userService&#34;</span>, UserService.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        userservice.<span style="color:#658b00">add</span>();
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div></li>
<li>
<p>结果</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#888">方法执行前
</span></span></span><span style="display:flex;"><span><span style="color:#888">增加了有一个用户
</span></span></span><span style="display:flex;"><span><span style="color:#888">方法执行后
</span></span></span></code></pre></div></li>
</ol>
<h4 id="方式三注解实现">方式三：注解实现</h4>
<ol>
<li>
<p>切面类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.diy</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.aspectj.lang.annotation.After</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.aspectj.lang.annotation.Aspect</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.aspectj.lang.annotation.Before</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * @Aspect: 标注这个类是切面类
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Aspect</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">AnonCut</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Before</span>(value = <span style="color:#cd5555">&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">before</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;方法执行前&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@After</span>(value = <span style="color:#cd5555">&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">after</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;方法执行后&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p>bean.xml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:aop=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;userService&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.service.impl.UserServiceimpl&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;log&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.log.Log&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;afterLog&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.log.AfterLog&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--需要导入aop的约束
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    xmlns:aop=&#34;http://www.springframework.org/schema/aop&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--方式一:原生API--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;aop:config&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &amp;lt;!&amp;ndash;切入点expression表达式 expression(要执行的位置 修饰词(public/private等) 返回值 类名 方法名 参数)&amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:pointcut id=&#34;poincut&#34; expression=&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &amp;lt;!&amp;ndash;执行环绕增加! 将log类和afterLog类切入到上面配置的方法上 &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:advisor advice-ref=&#34;log&#34; pointcut-ref=&#34;poincut&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:advisor advice-ref=&#34;afterLog&#34; pointcut-ref=&#34;poincut&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;/aop:config&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--方式二:自定义类--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;bean id=&#34;diy&#34; class=&#34;lv.diy.DiyPoinCut&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;aop:config&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &amp;lt;!&amp;ndash;挂载自定义类的beanid&amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;aop:aspect ref=&#34;diy&#34;&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--            &amp;lt;!&amp;ndash;切入点&amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--            &lt;aop:pointcut id=&#34;point&#34; expression=&#34;execution(* lv.service.impl.UserServiceimpl.*(..))&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--            &amp;lt;!&amp;ndash;通知&amp;ndash;&amp;gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--            &lt;aop:before method=&#34;before&#34; pointcut-ref=&#34;point&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--            &lt;aop:after method=&#34;after&#34; pointcut-ref=&#34;point&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--        &lt;/aop:aspect&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--    &lt;/aop:config&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--方式三： 注解--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;annoncut&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.diy.AnonCut&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--开启注解支持--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;aop:aspectj-autoproxy/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="8spring整合mybatis">8.Spring整合Mybatis</h2>
<h3 id="mybatis基础">mybatis基础</h3>
<h4 id="1-导入依赖包">1. 导入依赖包</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;project</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;parent&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>spring<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>com.lv<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/parent&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;modelVersion&gt;</span>4.0.0<span style="color:#8b008b;font-weight:bold">&lt;/modelVersion&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>spring-06-mybatis<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;properties&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;maven.compiler.source&gt;</span>8<span style="color:#8b008b;font-weight:bold">&lt;/maven.compiler.source&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;maven.compiler.target&gt;</span>8<span style="color:#8b008b;font-weight:bold">&lt;/maven.compiler.target&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/properties&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--spring相关包--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.springframework<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>spring-webmvc<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>5.3.9<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--mybatis--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.mybatis<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>mybatis<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>3.5.1<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--mysql数据库核心包--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>mysql<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>mysql-connector-java<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>8.0.16<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--jdbc连接--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.springframework<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>spring-jdbc<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>5.1.7.RELEASE<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--aop--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.aspectj<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>aspectjweaver<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>1.9.4<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--spring整合mybatis--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.mybatis<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>mybatis-spring<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>2.0.1<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--mariadbjdbc--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.mariadb.jdbc<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>mariadb-java-client<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>2.1.2<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--配置加载xml--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;build&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;resources&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;resource&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;directory&gt;</span>src/main/java<span style="color:#8b008b;font-weight:bold">&lt;/directory&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;includes&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">&lt;include&gt;</span>**/*.xml<span style="color:#8b008b;font-weight:bold">&lt;/include&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;/includes&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;filtering&gt;</span>true<span style="color:#8b008b;font-weight:bold">&lt;/filtering&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;/resource&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/build&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/project&gt;</span>
</span></span></code></pre></div><h4 id="2-mybatis配置文件">2. mybatis配置文件</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">&lt;!DOCTYPE configuration
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--别名--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;typeAliases&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;package</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;lv.pojo.User&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/typeAliases&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--环境配置--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;environments</span> <span style="color:#658b00">default=</span><span style="color:#cd5555">&#34;development&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;environment</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;development&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;transactionManager</span> <span style="color:#658b00">type=</span><span style="color:#cd5555">&#34;JDBC&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;dataSource</span> <span style="color:#658b00">type=</span><span style="color:#cd5555">&#34;POOLED&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;driver&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;org.mariadb.jdbc.Driver&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;url&#34;</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;jdbc:mariadb://localhost:3306/lvxiaobin?useSSl=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;username&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;lv&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;password&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;xiao&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&lt;/dataSource&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;/environment&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/environments&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--配置xml--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;mappers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;mapper</span> <span style="color:#658b00">resource=</span><span style="color:#cd5555">&#34;lv/mapper/xml/UserMapper.xml&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/mappers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h4 id="3-maper">3. maper</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">&lt;!DOCTYPE mapper
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;mapper</span> <span style="color:#658b00">namespace=</span><span style="color:#cd5555">&#34;lv.mapper.UserMapper&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;select</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;selectUser&#34;</span> <span style="color:#658b00">resultType=</span><span style="color:#cd5555">&#34;lv.pojo.User&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        select * from user;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/mapper&gt;</span>
</span></span></code></pre></div><h4 id="4-接口">4. 接口</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.mapper</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.pojo.User</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.List</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">interface</span> <span style="color:#008b45;font-weight:bold">UserMapper</span> {
</span></span><span style="display:flex;"><span>    List&lt;User&gt; <span style="color:#008b45">selectUser</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="5-实体类">5. 实体类</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.pojo</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">User</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> id;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> age;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">int</span> <span style="color:#008b45">getId</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> id;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setId</span>(<span style="color:#00688b;font-weight:bold">int</span> id) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">id</span> = id;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">int</span> <span style="color:#008b45">getAge</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setAge</span>(<span style="color:#00688b;font-weight:bold">int</span> age) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">age</span> = age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">toString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;User{&#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;id=&#34;</span> + id +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, name=&#39;&#34;</span> + name + <span style="color:#cd5555">&#39;\&#39;&#39;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;, age=&#34;</span> + age +
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#39;}&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="6-测试">6. 测试</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.mapper.UserMapper</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.pojo.User</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.apache.ibatis.io.Resources</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.apache.ibatis.session.SqlSession</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.apache.ibatis.session.SqlSessionFactory</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.apache.ibatis.session.SqlSessionFactoryBuilder</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.mybatis.spring.SqlSessionFactoryBean</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.io.IOException</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.io.InputStream</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.List</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Test</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@org.junit.Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">userTest</span>() <span style="color:#8b008b;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>        String resouce = <span style="color:#cd5555">&#34;mybatis-config.xml&#34;</span>;
</span></span><span style="display:flex;"><span>        InputStream resourceAsStream = Resources.<span style="color:#658b00">getResourceAsStream</span>(resouce);
</span></span><span style="display:flex;"><span>        SqlSessionFactory build = <span style="color:#8b008b;font-weight:bold">new</span> SqlSessionFactoryBuilder().<span style="color:#658b00">build</span>(resourceAsStream);
</span></span><span style="display:flex;"><span>        SqlSession sqlSession = build.<span style="color:#658b00">openSession</span>(<span style="color:#8b008b;font-weight:bold">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        UserMapper mapper = sqlSession.<span style="color:#658b00">getMapper</span>(UserMapper.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        List&lt;User&gt; users = mapper.<span style="color:#658b00">selectUser</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(users);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="整合方式一">整合方式一</h3>
<h4 id="1编写数据源">1.编写数据源</h4>
<h4 id="2-sqlsessionfactory">2. sqlSessionFactory</h4>
<h4 id="3sqlsessiontemplate">3.sqlSessionTemplate</h4>
<blockquote>
<p>把原来写的mybatis-config.xml中配置转移到spring-dao.xml中</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">&lt;!DOCTYPE configuration
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--别名--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;typeAliases&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;package</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;lv.pojo.User&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/typeAliases&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--环境配置--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;environments default=&#34;development&#34;&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--        &lt;environment id=&#34;development&#34;&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--            &lt;transactionManager type=&#34;JDBC&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--            &lt;dataSource type=&#34;POOLED&#34;&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--                &lt;property name=&#34;driver&#34; value=&#34;org.mariadb.jdbc.Driver&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--                &lt;property name=&#34;url&#34;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--                          value=&#34;jdbc:mariadb://localhost:3306/lvxiaobin?useSSl=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--                &lt;property name=&#34;username&#34; value=&#34;lv&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--                &lt;property name=&#34;password&#34; value=&#34;xiao&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--            &lt;/dataSource&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--        &lt;/environment&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;/environments&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--配置xml--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;mappers&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--        &lt;mapper resource=&#34;lv/mapper/xml/UserMapper.xml&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">&lt;!--    &lt;/mappers&gt;--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></div><blockquote>
<p>创建spring-dao.xml用来专门配置mybatis</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    dateSource:使用spring的数据源替换mybatis配置 c3p0 dbcp druid
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    使用spring提供的jdbc,需要在pom中导spring-jdbc依赖
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;dateSource&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;org.springframework.jdbc.datasource.DriverManagerDataSource&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;url&#34;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;jdbc:mariadb://localhost:3306/lvxiaobin?useSSl=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;username&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;lv&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;password&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;xiao&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;schema&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;lvxiaobin&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--sqlSessionFactory--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;sqlSessionFactory&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;dataSource&#34;</span> <span style="color:#658b00">ref=</span><span style="color:#cd5555">&#34;dateSource&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--绑定mybatis配置文件--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--可以使用此方法配置别名,完全舍弃mybatis-config.xml中的配置--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;typeAliases&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;lv.pojo.User&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--        &lt;property name=&#34;configLocation&#34; value=&#34;classpath:mybatis-config.xml&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;mapperLocations&#34;</span> <span style="color:#658b00">value=</span><span style="color:#cd5555">&#34;classpath:lv/mapper/xml/*.xml&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--SqlSessionTemplate就是sqlSession--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;sqlSession&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;org.mybatis.spring.SqlSessionTemplate&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">&lt;!--只能用构造器注入sqlSessionFactory,因为只有构造器注入,没有set方法--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;constructor-arg</span> <span style="color:#658b00">index=</span><span style="color:#cd5555">&#34;0&#34;</span> <span style="color:#658b00">ref=</span><span style="color:#cd5555">&#34;sqlSessionFactory&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div><h4 id="4给接口添加实现类">4.给接口添加实现类</h4>
<blockquote>
<p>编写UserMapper的实现类</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.mapper</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.pojo.User</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.mybatis.spring.SqlSessionTemplate</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.List</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserMapperImpl</span> <span style="color:#8b008b;font-weight:bold">implements</span> UserMapper {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//原来所有的操作都使用sqlSession操作,但是现在都用sqlSessionTemplate
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">private</span> SqlSessionTemplate sqlSessionTemplate;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//使用set方法在applicationContext.xml中注入
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setSqlSessionTemplate</span>(SqlSessionTemplate sqlSessionTemplate) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">sqlSessionTemplate</span> = sqlSessionTemplate;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> List&lt;User&gt; <span style="color:#008b45">selectUser</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> sqlSessionTemplate.<span style="color:#658b00">getMapper</span>(UserMapper.<span style="color:#658b00">class</span>).<span style="color:#658b00">selectUser</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="5将实现类注入到spring">5.将实现类注入到spring</h4>
<blockquote>
<p>创建applicationContext.xml用来统一管理其他的子xml</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;beans</span> <span style="color:#658b00">xmlns=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xmlns:xsi=</span><span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#658b00">xsi:schemaLocation=</span><span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    使用一个applicationContext统一管理多个xml
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--引入数据库配置spring-dao.xml--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;import</span> <span style="color:#658b00">resource=</span><span style="color:#cd5555">&#34;spring-dao.xml&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">&lt;!--注入UserMapperImpl--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;bean</span> <span style="color:#658b00">id=</span><span style="color:#cd5555">&#34;userMapper&#34;</span> <span style="color:#658b00">class=</span><span style="color:#cd5555">&#34;lv.mapper.UserMapperImpl&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;property</span> <span style="color:#658b00">name=</span><span style="color:#cd5555">&#34;sqlSessionTemplate&#34;</span> <span style="color:#658b00">ref=</span><span style="color:#cd5555">&#34;sqlSession&#34;</span><span style="color:#8b008b;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/beans&gt;</span>
</span></span></code></pre></div><h4 id="6测试">6.测试</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#707a7c">@org.junit.Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">userImplTest</span>(){
</span></span><span style="display:flex;"><span>        ApplicationContext applicationContext = <span style="color:#8b008b;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="color:#cd5555">&#34;applicationContext.xml&#34;</span>);
</span></span><span style="display:flex;"><span>        UserMapper userMapper = applicationContext.<span style="color:#658b00">getBean</span>(<span style="color:#cd5555">&#34;userMapper&#34;</span>, UserMapper.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        List&lt;User&gt; users = userMapper.<span style="color:#658b00">selectUser</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(users);
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="方式二">方式二</h3>
<blockquote>
<p>相比与方式一,只是继承了<code>SqlSessionDaoSupport</code>,省略了set方法,其他的一样</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">lv.mapper</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">lv.pojo.User</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">org.mybatis.spring.support.SqlSessionDaoSupport</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.List</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">UserMapperImpl2</span> <span style="color:#8b008b;font-weight:bold">extends</span> SqlSessionDaoSupport <span style="color:#8b008b;font-weight:bold">implements</span> UserMapper {
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> List&lt;User&gt; <span style="color:#008b45">selectUser</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> getSqlSession().<span style="color:#658b00">getMapper</span>(UserMapper.<span style="color:#658b00">class</span>).<span style="color:#658b00">selectUser</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="spring控制事务">spring控制事务</h3>
<blockquote>
<p>配合aop配置,只有xml需要更改</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>&lt;?xml version=<span style="color:#cd5555">&#34;1.0&#34;</span> encoding=<span style="color:#cd5555">&#34;UTF-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;beans xmlns=<span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style="display:flex;"><span>       xmlns:xsi=<span style="color:#cd5555">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>       xmlns:aop=<span style="color:#cd5555">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span style="display:flex;"><span>       xmlns:tx=<span style="color:#cd5555">&#34;http://www.springframework.org/schema/tx&#34;</span>
</span></span><span style="display:flex;"><span>       xsi:schemaLocation=<span style="color:#cd5555">&#34;http://www.springframework.org/schema/beans
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/aop/spring-aop.xsd
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/tx
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">        http://www.springframework.org/schema/tx/spring-tx.xsd&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;!--
</span></span><span style="display:flex;"><span>    dateSource:<span style="color:#a61717;background-color:#e3d2d2">使用</span>spring<span style="color:#a61717;background-color:#e3d2d2">的数据源替换</span>mybatis<span style="color:#a61717;background-color:#e3d2d2">配置</span> c3p0 dbcp druid
</span></span><span style="display:flex;"><span>    <span style="color:#a61717;background-color:#e3d2d2">使用</span>spring<span style="color:#a61717;background-color:#e3d2d2">提供的</span>jdbc,<span style="color:#a61717;background-color:#e3d2d2">需要在</span>pom<span style="color:#a61717;background-color:#e3d2d2">中导</span>spring-jdbc<span style="color:#a61717;background-color:#e3d2d2">依赖</span>
</span></span><span style="display:flex;"><span>    --&gt;
</span></span><span style="display:flex;"><span>    &lt;bean id=<span style="color:#cd5555">&#34;dateSource&#34;</span> class=<span style="color:#cd5555">&#34;org.springframework.jdbc.datasource.DriverManagerDataSource&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;url&#34;</span>
</span></span><span style="display:flex;"><span>                  value=<span style="color:#cd5555">&#34;jdbc:mariadb://localhost:3306/lvxiaobin?useSSl=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;username&#34;</span> value=<span style="color:#cd5555">&#34;lv&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;password&#34;</span> value=<span style="color:#cd5555">&#34;xiao&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;schema&#34;</span> value=<span style="color:#cd5555">&#34;lvxiaobin&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;/bean&gt;
</span></span><span style="display:flex;"><span>    &lt;!--sqlSessionFactory--&gt;
</span></span><span style="display:flex;"><span>    &lt;bean id=<span style="color:#cd5555">&#34;sqlSessionFactory&#34;</span> class=<span style="color:#cd5555">&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;dataSource&#34;</span> ref=<span style="color:#cd5555">&#34;dateSource&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">绑定</span>mybatis<span style="color:#a61717;background-color:#e3d2d2">配置文件</span>--&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">可以使用此方法配置别名</span>,<span style="color:#a61717;background-color:#e3d2d2">完全舍弃</span>mybatis-config.<span style="color:#658b00">xml</span><span style="color:#a61717;background-color:#e3d2d2">中的配置</span>--&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;typeAliases&#34;</span> value=<span style="color:#cd5555">&#34;lv.pojo.IUser&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;property name=<span style="color:#cd5555">&#34;mapperLocations&#34;</span> value=<span style="color:#cd5555">&#34;classpath:lv/mapper/xml/*.xml&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;/bean&gt;
</span></span><span style="display:flex;"><span>    &lt;!--SqlSessionTemplate<span style="color:#a61717;background-color:#e3d2d2">就是</span>sqlSession--&gt;
</span></span><span style="display:flex;"><span>    &lt;bean id=<span style="color:#cd5555">&#34;sqlSession&#34;</span> class=<span style="color:#cd5555">&#34;org.mybatis.spring.SqlSessionTemplate&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">只能用构造器注入</span>sqlSessionFactory,<span style="color:#a61717;background-color:#e3d2d2">因为只有构造器注入</span>,<span style="color:#a61717;background-color:#e3d2d2">没有</span>set<span style="color:#a61717;background-color:#e3d2d2">方法</span>--&gt;
</span></span><span style="display:flex;"><span>        &lt;constructor-arg index=<span style="color:#cd5555">&#34;0&#34;</span> ref=<span style="color:#cd5555">&#34;sqlSessionFactory&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;/bean&gt;
</span></span><span style="display:flex;"><span>    &lt;!--<span style="color:#a61717;background-color:#e3d2d2">开启事务</span>--&gt;
</span></span><span style="display:flex;"><span>    &lt;bean id=<span style="color:#cd5555">&#34;transation&#34;</span> class=<span style="color:#cd5555">&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;constructor-arg ref=<span style="color:#cd5555">&#34;dateSource&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;/bean&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;!--<span style="color:#a61717;background-color:#e3d2d2">结合</span>AOP<span style="color:#a61717;background-color:#e3d2d2">插入事务</span>--&gt;
</span></span><span style="display:flex;"><span>    &lt;!--<span style="color:#a61717;background-color:#e3d2d2">配置事务通知</span>:--&gt;
</span></span><span style="display:flex;"><span>    &lt;tx:advice id=<span style="color:#cd5555">&#34;txAdvice&#34;</span> transaction-manager=<span style="color:#cd5555">&#34;transation&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;!--<span style="color:#a61717;background-color:#e3d2d2">给方法配置事务</span>--&gt;
</span></span><span style="display:flex;"><span>        &lt;tx:attributes&gt;
</span></span><span style="display:flex;"><span>            &lt;tx:method name=<span style="color:#cd5555">&#34;add&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>            &lt;tx:method name=<span style="color:#cd5555">&#34;delete&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>            &lt;tx:method name=<span style="color:#cd5555">&#34;update&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>            &lt;tx:method name=<span style="color:#cd5555">&#34;*&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;/tx:attributes&gt;
</span></span><span style="display:flex;"><span>    &lt;/tx:advice&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;aop:config&gt;
</span></span><span style="display:flex;"><span>        &lt;aop:pointcut id=<span style="color:#cd5555">&#34;txPoint&#34;</span> expression=<span style="color:#cd5555">&#34;execution(* lv.mapper.*.*(..))&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;aop:advisor advice-ref=<span style="color:#cd5555">&#34;txAdvice&#34;</span> pointcut-ref=<span style="color:#cd5555">&#34;txPoint&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;/aop:config&gt;
</span></span><span style="display:flex;"><span>&lt;/beans&gt;
</span></span></code></pre></div>
                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">最后修改于 2021-07-28</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/java/jdbc/">
			下回<br>Jdbc
                </a>
                
                
                
                <a class="older-posts" href="/posts/java/java%E4%B8%AD%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/">
			上回<br>Java中常用工具类
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                










            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
